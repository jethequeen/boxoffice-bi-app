version: "3.9"

services:
  seats-sold:
    build: .
    container_name: seats-sold
    restart: unless-stopped
    env_file:
      - .env.txt
    environment:
      - TZ=America/Toronto
      # daemon knobs
      - RESYNC_MIN=180
      - LOOKAHEAD_H=8
      - BACKPAD_MIN=30
      - FLUSH_MIN=60
      - FLUSH_BATCH=100
      - CHECK_DELAY_SEC=780
      - WINDOW_SEC=60
      - QUIET_START=01:00
      - QUIET_END=10:00

      # Make sure neither Playwright nor Puppeteer tries to download browsers
      - PLAYWRIGHT_BROWSERS_PATH=/ms-playwright
      - PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1
      - PUPPETEER_EXECUTABLE_PATH=/usr/local/bin/chromium-from-pw
      - PUPPETEER_CACHE_DIR=/home/pwuser/.cache/puppeteer

      # Optional verbose scraper logs
      # - WEBDEV_DEBUG=1

    # optional: persist logs, etc.
    # volumes:
    #   - ./logs:/boxoffice-bi-app/logs
