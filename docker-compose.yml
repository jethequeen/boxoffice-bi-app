version: "3.9"

services:
  seats-sold:
    build: .
    container_name: seats-sold
    restart: unless-stopped
    env_file:
      - .env.txt
    environment:
      - TZ=America/Toronto
      # daemon knobs
      - RESYNC_MIN=180
      - LOOKAHEAD_H=8
      - BACKPAD_MIN=30
      - FLUSH_MIN=60
      - FLUSH_BATCH=100
      - CHECK_DELAY_SECVEN?=780   # if you renamed this, keep your real var name
      - WINDOW_SEC=60
      - QUIET_START=01:00
      - QUIET_END=10:00

      # Ensure no downloads at runtime
      - PLAYWRIGHT_BROWSERS_PATH=/ms-playwright
      - PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=1
      - PUPPETEER_EXECUTABLE_PATH=/usr/local/bin/chromium-from-pw
      - PUPPETEER_CACHE_DIR=/home/pwuser/.cache/puppeteer

      # Optional verbose scraping logs
      # - WEBDEV_DEBUG=1

    # Uncomment if you want host logs, etc.
    # volumes:
    #   - ./logs:/boxoffice-bi-app/logs
